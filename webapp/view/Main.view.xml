<mvc:View
	controllerName="activity.weekly.controller.Main"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:core="sap.ui.core"
	xmlns:p="sap.m.plugins"
	xmlns="sap.m">
    <Page id="WeeklyActivityID" busy="true">
        <Table id="WeeklyActivityTable"
            inset="false"
            items="{
                path: 'WeeklyActivity>/',
                sorter: {
                    path: 'WeekEnding',
                    descending: true
                }
            }"
            growing="true"
            growingScrollToLoad="false"
            growingThreshold="10"
            width="100%">
            <headerToolbar>
                <OverflowToolbar>
                    <content>
                        <MultiComboBox
                            id="mcbCalendarYearID"
                            width="350px"
                            items="{
                                path: 'WarYears>/',
                                sorter: {
                                    path: 'key',
                                    descending: true
                                }
                            }"
                            enabled="true"
                            placeholder="{i18n>calendarYear}"
                            selectionFinish="setYear"
                        >
                            <core:Item
                                key="{WarYears>key}"
                                text="{WarYears>text}"
                            />
                        </MultiComboBox>

                        <MultiComboBox
                            id="mcbWeekCalendarYearID"
                            width="350px"
                            items="{
                                path: 'WarWeeks>/',
                                sorter: {
                                    path: 'key',
                                    descending: true
                                }
                            }"
                            enabled="true"
                            placeholder="{i18n>weekCalendarYear}"
                        >
                            <core:Item
                                key="{WarWeeks>key}"
                                text="{WarWeeks>text}"
                            />
                        </MultiComboBox>

                        <Button
                            text="{i18n>go}"
                            press="warFiler"
                            type="Emphasized"
                            icon="sap-icon://search"
                        />

                        <ToolbarSpacer />

                        <MenuButton
                            text="{i18n>export}"
                            defaultAction="onDefaultAction"
                            beforeMenuOpen="onBeforeMenuOpen"
                            useDefaultActionOnly="true" 
                            menuPosition="RightBottom"
                            icon="sap-icon://download">
                            <menu>
                                <Menu itemSelected="onMenuAction">
                                    <MenuItem text="{i18n>excel}" icon="sap-icon://excel-attachment" />
                                    <MenuItem text="{i18n>pdf}" icon="sap-icon://pdf-attachment" />
                                    <MenuItem text="{i18n>csv}" icon="sap-icon://document" />
                                </Menu>
                            </menu>
		                </MenuButton>
                    </content>
                </OverflowToolbar>
            </headerToolbar>
            <columns>
                <Column
                    width="12em">
                    <Text text="{i18n>weekCalendarYear}" />
                </Column>
                <Column
                    minScreenWidth="Tablet"
                    demandPopin="true">
                    <Text text="{i18n>mainProductCategories}" />
                </Column>
                <Column
                    minScreenWidth="Tablet"
                    demandPopin="true"
                    hAlign="Center">
                    <Text text="{i18n>visit}" />
                </Column>
                <Column
                    minScreenWidth="Tablet"
                    demandPopin="true"
                    hAlign="Center">
                    <Text text="{i18n>employeeResponsible}" />
                </Column>
                <Column
                    hAlign="Center"
                    minScreenWidth="Tablet"
                    demandPopin="true">
                    <Text text="{i18n>account}" />
                </Column>
                <Column
                    hAlign="Center"
                    minScreenWidth="Tablet"
                    demandPopin="true">
                    <Text text="{i18n>notes}" />
                </Column>
                <Column
                    hAlign="Center"
                    minScreenWidth="Tablet"
                    demandPopin="true">
                    <Text text="{i18n>image}" />
                </Column>
                <Column
                    hAlign="Center"
                    minScreenWidth="Tablet"
                    demandPopin="true">
                    <Text text="{i18n>activityDetails}" />
                </Column>
                <Column
                    hAlign="Center"
                    minScreenWidth="Tablet"
                    demandPopin="true">
                    <Text text="{i18n>purpose}" />
                </Column>
            </columns>
            <items>
                <ColumnListItem vAlign="Middle">
                    <cells>
                        <Text text="{WeeklyActivity>WeekEnding}"/>
                        <Text text="{WeeklyActivity>Ts1ANsDFE1FAA8A417519}"/>
                        <Text text="{WeeklyActivity>TAPA_DOC_UUID}"/>
                        <Text text="{WeeklyActivity>TAPA_PTY_MAINEMPLRESPP}"/>
                        <Text text="{WeeklyActivity>TAPA_PTY_MAINACTIVITYP}"/>
                        <Text text="{WeeklyActivity>CDOC_NOTES}"/>
                        <Image
                            src="{WeeklyActivity>DocumentLink}"
                            width="50px"
                            height="50px"
                            press="onImagePress"
                            tooltip="Click to view full image"
                        />
                        <Text text="{WeeklyActivity>Ts1ANsBFEACD52FCDD795}"/>
                        <Text text="{WeeklyActivity>Ts1ANsEE730D1E08E7B3B}"/>
                    </cells>
                </ColumnListItem>
            </items>
        </Table>
    </Page>
</mvc:View>